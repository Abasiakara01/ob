<!DOCTYPE html><html>
<head>
  <meta charset="UTF-8" />
  <title>Pro Car Game</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root{--w:400px;--h:600px}
    body{margin:0;background:#0b0b0f;display:flex;min-height:100vh;align-items:center;justify-content:center;color:#fff;font-family:Arial}
    #container{width:var(--w);height:var(--h);position:relative;overflow:hidden;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,0.8);}
    /* parallax bg */
    .bgLayer{position:absolute;inset:0;background-repeat:repeat-y;background-position:center top;background-size:cover;will-change:transform}
    #bgFar{background-image:url('https://i.ibb.co/3vY2q5S/city-far.png');opacity:0.7;transform:translateY(0)}
    #bgNear{background-image:url('https://i.ibb.co/0VBxv1k/city-near.png');opacity:0.9;transform:translateY(0)}#gameArea{position:absolute;inset:0;padding:0;margin:0;display:block}
/* lanes */
.lane{position:absolute;top:0;bottom:0;width:33.3333%;border-left:1px dashed rgba(255,255,255,0.06);}
.lane:nth-child(1){left:0}
.lane:nth-child(2){left:33.3333%}
.lane:nth-child(3){left:66.6666%}

/* road center dashed lines */
.roadLine{position:absolute;width:10px;height:60px;background:#fff;left:50%;transform:translateX(-50%);border-radius:3px;opacity:0.9}

/* player & enemy */
.car{width:70px;height:120px;background-size:cover;position:absolute;bottom:20px;left:50%;transform:translateX(-50%);transition:left 0.12s linear}
.enemy{width:70px;height:120px;background-size:cover;position:absolute;top:-140px;left:50%;transform:translateX(-50%)}

/* flame nitro */
.nitroFlame{position:absolute;width:40px;height:40px;bottom:30px;left:50%;transform:translateX(40px);background-image:url('https://i.ibb.co/4Z3n7gB/flame.png');background-size:cover;opacity:0;pointer-events:none;transition:opacity .1s}

/* powerups */
.power{width:40px;height:40px;position:absolute;top:-60px;background-size:cover}
.shield{background-image:url('https://i.ibb.co/2tqg2wq/shield.png')}
.magnet{background-image:url('https://i.ibb.co/3yQy1nC/magnet.png')}
.slow{background-image:url('https://i.ibb.co/0s6rQzW/slow.png')}
.fuel{background-image:url('https://i.ibb.co/bKzvQx3/fuel.png')}

/* UI */
#hud{position:absolute;z-index:40;left:8px;top:8px;font-weight:bold}
#hud div{margin-bottom:6px}
#menuOverlay,#carSelect,#garageOverlay,#leaderboardOverlay{position:absolute;inset:0;z-index:50;background:rgba(0,0,0,0.85);display:flex;align-items:center;justify-content:center;flex-direction:column;padding:20px}
.menuBtn{padding:10px 16px;margin:8px;font-size:16px;border-radius:8px;border:none;background:#1e90ff;color:#fff;cursor:pointer}

/* joystick */
#joystick{position:absolute;left:12px;bottom:12px;width:120px;height:120px;border-radius:50%;background:rgba(255,255,255,0.04);touch-action:none}
#joyKnob{position:absolute;left:35px;top:35px;width:50px;height:50px;border-radius:50%;background:rgba(255,255,255,0.12)}

/* explosion */
.explosion{position:absolute;width:160px;height:160px;left:50%;transform:translateX(-50%);bottom:10px;background-image:url('https://i.ibb.co/0VqKq0y/explosion.png');background-size:cover;opacity:0;pointer-events:none}

/* small controls */
#controls{position:absolute;right:8px;top:8px;z-index:40;display:flex;flex-direction:column;gap:8px}
.smallBtn{padding:6px 8px;border-radius:8px;border:none;background:rgba(255,255,255,0.08);color:#fff;cursor:pointer}

/* garage */
.shopItem{background:#151515;padding:12px;border-radius:8px;margin:6px;width:100%}

footer{position:absolute;bottom:6px;left:50%;transform:translateX(-50%);font-size:12px;opacity:0.6}

  </style>
</head>
<body>
  <div id="container">
    <div id="bgFar" class="bgLayer"></div>
    <div id="bgNear" class="bgLayer"></div><div id="gameArea">
  <!-- lanes -->
  <div class="lane"></div><div class="lane"></div><div class="lane"></div>
  <!-- road center lines (generated by script) -->

  <div id="playerWrap">
    <div id="player" class="car" style="background-image:url('https://i.ibb.co/4J8YV6c/car.png')"></div>
    <div class="nitroFlame" id="flame"></div>
    <div class="explosion" id="boom"></div>
  </div>

  <div id="hud">
    <div id="score">Score: 0</div>
    <div id="fuel">Fuel: 100%</div>
    <div id="high">High: 0</div>
  </div>

  <div id="controls">
    <button class="smallBtn" id="nitroBtn">Nitro</button>
    <button class="smallBtn" id="musicToggle">Music: On</button>
    <button class="smallBtn" id="garageBtn">Garage</button>
    <button class="smallBtn" id="leaderBtn">Leaderboard</button>
  </div>

  <div id="joystick"><div id="joyKnob"></div></div>
  <div id="menuOverlay">
    <h2>Pro Car Game</h2>
    <div style="display:flex;gap:8px;flex-direction:column;width:100%;max-width:320px">
      <button class="menuBtn" id="startBtn">Start Race</button>
      <button class="menuBtn" id="selectCarBtn">Select Car</button>
      <button class="menuBtn" id="openGarageBtn">Garage & Upgrades</button>
      <button class="menuBtn" id="viewLeaderboardBtn">View Leaderboard</button>
    </div>
    <footer>Tip: Use Nitro (button or Space) to boost. Collect fuel & power-ups.</footer>
  </div>

  <!-- Car Selection -->
  <div id="carSelect" style="display:none">
    <h3>Choose your car</h3>
    <div style="display:flex;gap:8px">
      <button class="menuBtn carChoice" data-img="https://i.ibb.co/4J8YV6c/car.png">Red Car</button>
      <button class="menuBtn carChoice" data-img="https://i.ibb.co/2s2sR6b/car-blue.png">Blue Car</button>
      <button class="menuBtn carChoice" data-img="https://i.ibb.co/9r1gKJg/car-green.png">Green Car</button>
    </div>
    <button class="menuBtn" id="backFromSelect">Back</button>
  </div>

  <!-- Garage / Upgrades -->
  <div id="garageOverlay" style="display:none;overflow:auto;padding:20px">
    <h3>Garage & Upgrades</h3>
    <div style="width:100%">
      <div class="shopItem">Coins: <span id="coins">0</span></div>
      <div class="shopItem">Boost Power: <span id="uBoost">1</span> <button class="menuBtn" id="buyBoost">Buy (+0.2)</button></div>
      <div class="shopItem">Fuel Efficiency: <span id="uFuel">1</span> <button class="menuBtn" id="buyFuel">Buy (+0.2)</button></div>
      <div class="shopItem">Max Nitro: <span id="uNitro">1</span> <button class="menuBtn" id="buyNitro">Buy (+1)</button></div>
    </div>
    <button class="menuBtn" id="closeGarage">Close</button>
  </div>

  <!-- Leaderboard -->
  <div id="leaderboardOverlay" style="display:none;padding:20px">
    <h3>Leaderboard</h3>
    <ol id="leaderList"></ol>
    <button class="menuBtn" id="closeLeader">Close</button>
  </div>

</div>

  </div><script>
/* ======= Game variables ======= */
const LANE_COUNT = 3;
const LANE_WIDTH = document.querySelector('.lane').offsetWidth;
let lanePositions = [];
for(let i=0;i<LANE_COUNT;i++) lanePositions.push(i*LANE_WIDTH + LANE_WIDTH/2 - 35); // center offset

const player = document.getElementById('player');
const flame = document.getElementById('flame');
const boom = document.getElementById('boom');
const scoreEl = document.getElementById('score');
const fuelEl = document.getElementById('fuel');
const highEl = document.getElementById('high');
const menuOverlay = document.getElementById('menuOverlay');
const carSelect = document.getElementById('carSelect');
const garageOverlay = document.getElementById('garageOverlay');
const leaderOverlay = document.getElementById('leaderboardOverlay');
const leaderList = document.getElementById('leaderList');

let gameRunning=false,playerLane=1,score=0,fuel=100,speed=3,baseSpeed=3,nitroAvailable=3,coins=0;
let shield=false,magnet=false,slow=false;let boostLevel=1,fuelLevel=1,nitroLevel=1; // upgrades
let musicOn=true;

// audio
const music = new Audio('https://actions.google.com/sounds/v1/ambiences/medium_crowd.ogg'); music.loop=true; music.volume=0.15;
const engine = new Audio('https://actions.google.com/sounds/v1/transportation/car_engine_idle_loop.ogg'); engine.loop=true; engine.volume=0.3;
const crashSnd = new Audio('https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg');
const pickupSnd = new Audio('https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg');

// leaderboard
let leaderboard = JSON.parse(localStorage.getItem('pc_leaderboard')||'[]');
let highScore = parseInt(localStorage.getItem('pc_high')||'0'); highEl.textContent='High: '+highScore;
let coinsStorage = parseInt(localStorage.getItem('pc_coins')||'0'); coins=coinsStorage; document.getElementById('coins').textContent=coins;
let upgrades = JSON.parse(localStorage.getItem('pc_upgrades')||JSON.stringify({boost:0,fuel:0,nitro:0})); boostLevel=1+upgrades.boost*0.2; fuelLevel=1+upgrades.fuel*0.2; nitroLevel=1+upgrades.nitro; document.getElementById('uBoost').textContent= (boostLevel).toFixed(1); document.getElementById('uFuel').textContent=(fuelLevel).toFixed(1); document.getElementById('uNitro').textContent=(nitroLevel);

/* ======= Parallax background ======= */
const bgFar = document.getElementById('bgFar');
const bgNear = document.getElementById('bgNear');
let bgPosFar=0,bgPosNear=0;
function moveBg(){bgPosFar+=0.4*speed;bgPosNear+=1.0*speed;bgFar.style.transform=translateY(${bgPosFar}px);bgNear.style.transform=translateY(${bgPosNear}px);requestAnimationFrame(moveBg);}moveBg();

/* ======= Generators ======= */
const gameArea = document.getElementById('gameArea');
let roadLines=[];let enemies=[];let powers=[];
function createRoadLines(){for(let i=0;i<8;i++){let rl=document.createElement('div');rl.classList.add('roadLine');rl.style.top=(i*100)+'px';gameArea.appendChild(rl);roadLines.push(rl);} }
function moveRoadLines(){roadLines.forEach(rl=>{let y=parseInt(rl.style.top);y+=speed*10;if(y>600)y=-120;rl.style.top=y+'px';});}
function spawnEnemy(){let e=document.createElement('div');e.className='enemy';e.style.backgroundImage="url('https://i.ibb.co/1K9d6G7/enemy.png')"; let lane=Math.floor(Math.random()*LANE_COUNT); e.style.left=lanePositions[lane]+'px'; e.dataset.lane=lane; e.style.top='-140px';gameArea.appendChild(e);enemies.push(e);}function moveEnemies(){for(let i=enemies.length-1;i>=0;i--){let e=enemies[i];let y=parseInt(e.style.top);y+=speed*6; e.style.top=y+'px'; if(y>650){e.remove();enemies.splice(i,1);spawnEnemy(); score+=1; scoreEl.textContent='Score: '+score; coins+=1; document.getElementById('coins').textContent=coins; localStorage.setItem('pc_coins',coins);} // collision
 if(y>440 && Math.abs(parseInt(e.style.left)-lanePositions[playerLane])<40){ if(shield){shield=false; pickupSnd.play(); e.remove(); enemies.splice(i,1); spawnEnemy(); } else {doExplosion(); return;} }}}

// powerups spawn
function spawnPower(){let types=['shield','magnet','slow','fuel']; let t=types[Math.floor(Math.random()*types.length)]; let p=document.createElement('div'); p.className='power '+(t==='fuel'?'fuel':t); p.dataset.type=t; let lane=Math.floor(Math.random()*LANE_COUNT); p.style.left=lanePositions[lane]+'px'; p.style.top='-60px'; gameArea.appendChild(p); powers.push(p);}function movePowers(){for(let i=powers.length-1;i>=0;i--){let p=powers[i];let y=parseInt(p.style.top);y+=speed*5; p.style.top=y+'px'; if(y>650){p.remove();powers.splice(i,1); spawnPower();} if(y>440 && Math.abs(parseInt(p.style.left)-lanePositions[playerLane])<40){ let t=p.dataset.type; pickupSnd.play(); if(t==='shield'){shield=true;} if(t==='magnet'){magnet=true; setTimeout(()=>magnet=false,8000);} if(t==='slow'){slow=true; speed=Math.max(2,speed-2); setTimeout(()=>{slow=false;speed=baseSpeed+score*0.02;},6000);} if(t==='fuel'){fuel=Math.min(100,fuel+30);} p.remove(); powers.splice(i,1); spawnPower();}}}

/* ======= Player controls & movement ======= */
function setPlayerLane(n){playerLane=Math.max(0,Math.min(LANE_COUNT-1,n)); player.style.left=lanePositions[playerLane]+'px';}
setPlayerLane(1);

document.addEventListener('keydown',e=>{if(!gameRunning) return; if(e.key==='ArrowLeft') setPlayerLane(playerLane-1); if(e.key==='ArrowRight') setPlayerLane(playerLane+1); if(e.key===' ') useNitro();});

// simple joystick
const joy=document.getElementById('joystick'); const knob=document.getElementById('joyKnob'); let dragging=false,joyCenter={x:0,y:0};
function joyStart(e){dragging=true; let r=joy.getBoundingClientRect(); joyCenter={x:r.left+r.width/2,y:r.top+r.height/2}; knob.style.left='35px';knob.style.top='35px';}
function joyMove(e){if(!dragging||!gameRunning) return; let evt = e.touches?e.touches[0]:e; let dx=evt.clientX-joyCenter.x; if(dx<-20) setPlayerLane(playerLane-1); if(dx>20) setPlayerLane(playerLane+1);}function joyEnd(){dragging=false;knob.style.left='35px';knob.style.top='35px';}
joy.addEventListener('touchstart',joyStart); joy.addEventListener('touchmove',joyMove); joy.addEventListener('touchend',joyEnd);

/* ======= Nitro ======= */
function useNitro(){ if(nitroAvailable<=0) return; nitroAvailable--; flame.style.opacity=1; let prevSpeed=speed; speed += 4*boostLevel; setTimeout(()=>{flame.style.opacity=0; speed=prevSpeed;},1000); }
document.getElementById('nitroBtn').addEventListener('click',useNitro);

/* ======= Explosion & Game Over ======= */
function doExplosion(){ gameRunning=false; engine.pause(); crashSnd.play(); boom.style.opacity=1; setTimeout(()=>{boom.style.opacity=0; endGame();},800); }
function endGame(){ // save score, leaderboard
 if(score>highScore){ highScore=score; localStorage.setItem('pc_high',highScore);} leaderboard.push({score:score,date:Date.now()}); leaderboard.sort((a,b)=>b.score-a.score); leaderboard=leaderboard.slice(0,10); localStorage.setItem('pc_leaderboard',JSON.stringify(leaderboard)); localStorage.setItem('pc_coins',coins); // show menu
 alert('Game Over! Score: '+score); location.reload(); }

/* ======= Fuel drain & loops ======= */
function fuelDrain(){ if(!gameRunning) return; fuel -= 0.15/fuelLevel; if(fuel<=0){doExplosion(); return;} fuelEl.textContent='Fuel: '+Math.floor(fuel)+'%'; setTimeout(fuelDrain,200);} 

/* ======= Main loop ======= */
function mainLoop(){ if(!gameRunning) return; moveRoadLines(); moveEnemies(); movePowers(); // magnet effect
 if(magnet){ // pull coins (we simulate coins by increasing when enemies pass)
 }
 // slowly increase difficulty
 speed = baseSpeed + score*0.02; requestAnimationFrame(mainLoop);} 

/* ======= Spawning intervals ======= */n
let spawnIntervals = [];
function startSpawns(){ spawnIntervals.push(setInterval(spawnEnemy,1500)); spawnIntervals.push(setInterval(spawnPower,6000)); }
function stopSpawns(){ spawnIntervals.forEach(i=>clearInterval(i)); spawnIntervals=[]; }

/* ======= UI Buttons ======= */
document.getElementById('startBtn').addEventListener('click',()=>{ startRace(); menuOverlay.style.display='none';});
document.getElementById('selectCarBtn').addEventListener('click',()=>{ menuOverlay.style.display='none'; carSelect.style.display='flex';});
document.getElementById('backFromSelect').addEventListener('click',()=>{ carSelect.style.display='none'; menuOverlay.style.display='flex';});
document.querySelectorAll('.carChoice').forEach(b=>b.addEventListener('click',(e)=>{ let img=e.target.dataset.img; player.style.backgroundImage=url('${img}'); carSelect.style.display='none'; menuOverlay.style.display='flex';}));

document.getElementById('garageBtn').addEventListener('click',()=>{ menuOverlay.style.display='none'; openGarage();});
document.getElementById('openGarageBtn').addEventListener('click',()=>{ menuOverlay.style.display='none'; openGarage();});

document.getElementById('viewLeaderboardBtn').addEventListener('click',()=>{ menuOverlay.style.display='none'; openLeader();});

document.getElementById('musicToggle').addEventListener('click',()=>{ musicOn=!musicOn; if(musicOn){music.play(); document.getElementById('musicToggle').textContent='Music: On'} else{music.pause(); document.getElementById('musicToggle').textContent='Music: Off'} });

document.getElementById('garageBtn').addEventListener('click',openGarage); document.getElementById('leaderBtn').addEventListener('click',openLeader);

document.getElementById('closeGarage').addEventListener('click',()=>{garageOverlay.style.display='none'; menuOverlay.style.display='flex'; saveUpgrades();});
document.getElementById('closeLeader').addEventListener('click',()=>{leaderOverlay.style.display='none'; menuOverlay.style.display='flex';});

// buy upgrades
document.getElementById('buyBoost').addEventListener('click',()=>{ if(coins>=10){coins-=10; upgrades.boost++; boostLevel=1+upgrades.boost*0.2; document.getElementById('coins').textContent=coins; document.getElementById('uBoost').textContent=boostLevel.toFixed(1); localStorage.setItem('pc_upgrades',JSON.stringify(upgrades));}});
document.getElementById('buyFuel').addEventListener('click',()=>{ if(coins>=8){coins-=8; upgrades.fuel++; fuelLevel=1+upgrades.fuel*0.2; document.getElementById('coins').textContent=coins; document.getElementById('uFuel').textContent=fuelLevel.toFixed(1); localStorage.setItem('pc_upgrades',JSON.stringify(upgrades));}});
document.getElementById('buyNitro').addEventListener('click',()=>{ if(coins>=12){coins-=12; upgrades.nitro++; nitroLevel=1+upgrades.nitro; document.getElementById('coins').textContent=coins; document.getElementById('uNitro').textContent=nitroLevel; localStorage.setItem('pc_upgrades',JSON.stringify(upgrades));}});

function openGarage(){ garageOverlay.style.display='flex'; document.getElementById('coins').textContent=coins; }
function openLeader(){ leaderOverlay.style.display='flex'; renderLeader(); }
function renderLeader(){ leaderList.innerHTML=''; leaderboard.forEach((l,idx)=>{ let li=document.createElement('li'); li.textContent=(idx+1)+'. '+l.score+'  ('+new Date(l.date).toLocaleDateString()+')'; leaderList.appendChild(li); }); }

/* ======= Start & Reset ======= */
function startRace(){ // reset
 gameRunning=true; score=0; fuel=100; baseSpeed=3; speed=baseSpeed; nitroAvailable=3*nitroLevel; upgradeApply(); document.getElementById('high').textContent='High: '+highScore; scoreEl.textContent='Score: 0'; fuelEl.textContent='Fuel: 100%'; document.getElementById('coins').textContent=coins; createRoadLines(); startSpawns(); fuelDrain(); mainLoop(); engine.play(); music.play(); }

function upgradeApply(){ baseSpeed = 3 + (upgrades.boost*0.2); }

/* ======= Init ======= */
function init(){ // place player in lane
 setPlayerLane(1); document.getElementById('musicToggle').textContent = musicOn? 'Music: On':'Music: Off'; }
init();

</script></body>
</html>